<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/app.e5d44cb3cd153caeaaff.css">@import url(https://cdn.rawgit.com/tonsky/FiraCode/1.206/distr/fira_code.css);.gatsby-highlight{margin:1.58rem 0;overflow:auto}.gatsby-highlight pre[class*=language-]{border-radius:5px}code[class*=language-],pre[class*=language-]{font-family:Fira code!important;font-weight:400;-webkit-font-feature-settings:"calt" 1;font-feature-settings:"calt" 1;-webkit-font-variant-ligatures:contextual;font-variant-ligatures:contextual}.twitter-tweet{margin:1.58rem auto!important}:not(pre)>code[class*=language-]{padding:.1rem .25rem!important}@media (min-width:780px){.gatsby-highlight{margin-left:-26px!important;margin-right:-26px!important}.gatsby-resp-image-wrapper{margin-left:-25px!important;margin-right:-25px!important}}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.0.19"/><script>window.__EMOTION_CRITICAL_CSS_IDS__ = ["ybhu31","f5x87h","3r1208","bl4d1f","11wh14o","1ilyui9","pykqlk","5ga7d2","1421e1w","15tk48t","3ld94f","1iats6v","qo5yek","yjqqaa"];</script><style>.css-ybhu31{height:100%;overflow:auto;position:relative;}.css-f5x87h{width:100%;z-index:2;}.css-3r1208{text-align:center;overflow:auto;background:rgb(242,77,50);}.css-3r1208 h1{font-size:3.5rem;line-height:3.5rem;margin:2rem;}.css-3r1208 a,.css-3r1208 a:hover,.css-3r1208 a:visited{-webkit-text-decoration:none;text-decoration:none;font-family:Abril Fatface;color:#000;}.css-bl4d1f{width:100%;z-index:2;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-top:1rem;background:rgb(242,77,50);}.css-bl4d1f a,.css-bl4d1f a:hover,.css-bl4d1f a:visited{-webkit-text-decoration:none;text-decoration:none;color:#fff;}.css-11wh14o{position:absolute;top:0;left:0;width:0%;height:3px;background:#fff;}.css-1ilyui9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}.css-pykqlk{font-family:Roboto;font-style:normal;padding:0 20px 0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-5ga7d2{font-size:18px;padding:0 1.5rem;-webkit-text-decoration:none;text-decoration:none;}.css-5ga7d2::after{content:'';display:block;width:100%;margin-top:0.75rem;height:5px;-webkit-transition:-webkit-transform 250ms ease;-webkit-transition:transform 250ms ease;transition:transform 250ms ease;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);background-color:#fff;}.css-5ga7d2#active::after,.css-5ga7d2:hover::after{-webkit-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);}.css-1421e1w{height:65px;}.css-15tk48t{min-height:100%;overflow:auto;margin:0 auto;}.css-3ld94f{min-height:100%;max-width:780px;margin:0 auto 1rem auto;padding:0 0.5rem;}.css-1iats6v{padding:0px 1rem 1rem 1rem;}.css-qo5yek{margin-bottom:0;font-size:2.89rem;line-height:3.16rem;}.css-yjqqaa{color:rgba(0,0,0,0.54);margin-top:0;font-family:'Open Sans';font-weight:300;font-size:1.30384rem;line-height:1.58rem;}</style><title data-react-helmet="true">Bit fields in Javascript</title><link data-react-helmet="true" rel="canonical" href="https://emergent.systems/blog/bit-fields/"/><meta data-react-helmet="true" name="og:type" content="article"/><meta data-react-helmet="true" name="article:author" content="Peter J. Caulfield"/><meta data-react-helmet="true" name="og:description"/><meta data-react-helmet="true" name="twitter:description"/><meta data-react-helmet="true" name="og:title" content="Bit fields in Javascript"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.58 'Open Sans';box-sizing:border-box;overflow-y:scroll;font-smoothing:antialised;font-style:normal;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Open Sans';font-weight:500;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}h1{margin-left:0;margin-right:0;margin-top:3.16rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:1.7rem;line-height:2.37rem;}h2{margin-left:0;margin-right:0;margin-top:2.844rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.422rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:1.55611rem;line-height:2.37rem;}h3{margin-left:0;margin-right:0;margin-top:2.528rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.264rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:1.4244rem;line-height:2.37rem;}h4{margin-left:0;margin-right:0;margin-top:2.212rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.106rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:1.30384rem;line-height:1.58rem;}h5{margin-left:0;margin-right:0;margin-top:1.896rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.948rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:1.19348rem;line-height:1.58rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:inherit;font-family:'Merriweather';font-weight:700;text-rendering:optimizeLegibility;font-size:0.85284rem;line-height:1.075;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}ul{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;word-spacing:0.025em;color:#23212A;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.85rem;line-height:1.58rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1rem;line-height:1.58rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}blockquote{margin-left:1.58rem;margin-right:1.58rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.58rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.58rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}li > ul{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.58rem / 2);}code{font-size:0.85rem;line-height:1.58rem;}kbd{font-size:0.85rem;line-height:1.58rem;}samp{font-size:0.85rem;line-height:1.58rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.05333rem;padding-right:1.05333rem;padding-top:0.79rem;padding-bottom:calc(0.79rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}@media (min-width: 400px){html{font-size:106.25%;}}@media (min-width: 1000px){html{font-size:112.5%;}}h1,h2,h3,h4,h5,h6{color:#000;}ul, ol{margin-top:0.79rem;}a{color:#08B2E3;}a:visited{color:rgb(247,34,42);}</style><link href="//fonts.googleapis.com/css?family=Merriweather:700,500,400,300|Vollkorn:700,500,400,300|Open+Sans:700,500,400,300|Montserrat:700,500,400,300|Abril+Fatface:700,500,400,300|Roboto:700,500,400,300" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/0-77912da1a899ed9cb720.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-d79211abe6d5d7c17036.js"/><link as="script" rel="preload" href="/6-047ac21c7ff64682f062.js"/><link as="script" rel="preload" href="/app-085d23b9c77fd27162d3.js"/><link as="script" rel="preload" href="/webpack-runtime-f0271498a59faa340b94.js"/><link rel="preload" href="/static/d/905/path---blog-bit-fields-8-f-3-9f8-HhUAVOitfsQhnBmNWv3m0O8CJJk.json" as="fetch" crossOrigin="use-credentials"/></head><body style="background:rgb(252, 250, 243)"><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="css-ybhu31 ekjt4po2"><div class="css-f5x87h eqgcrdt0"><div class="css-3r1208 eqgcrdt1"><h1><a href="/">Emergent Systems</a></h1></div><div class="css-bl4d1f eqgcrdt2"><div class="css-11wh14o eqgcrdt7"></div><div class="css-1ilyui9 eqgcrdt3"><div class="css-pykqlk eqgcrdt6"><a class="css-5ga7d2 eqgcrdt5" id="active" href="/">Blog</a><a class="css-5ga7d2 eqgcrdt5" href="/about">About</a></div></div></div><div style="display:none" class="css-1421e1w eqgcrdt8"></div></div><div class="css-15tk48t ekjt4po0"><div class="css-3ld94f ekjt4po1"><div class="css-1iats6v ego4nxf0"><h1 class="css-qo5yek ego4nxf1">Bit fields in Javascript</h1><h2 class="css-yjqqaa ego4nxf2">Because sometimes you need a Tardis</h2><div><p>A bit field is a data structure that holds a sequence of bits.
They are sometimes referred to as “flags” and are typically
used to store the intermediate state or outcome of a set of operations in embedded
devices and microprocessors. They are useful data structures when you want
to optimise for space. Bitwise operations also tend to be blazing fast.</p>
<p>Bit fields are suitable for encoding state that is represented by boolean properties,
with the meaning of individual bits being determined by the programmer.
In javascript we can model a bit field simply with es6 binary primitives and
bitwise operators.</p>
<p>I stumbled across bit fields recently through this tweet from Andrew Clark,
a member of the ReactJS core team:</p>
<blockquote class="twitter-tweet" data-lang="en">
  <p lang="en" dir="ltr">React uses a bit field to track side effects. For example, to mark a component as updated:<br><br>fiber.effectTag |= Update<br><br>Then later to check whether to call componentDidUpdate:<br><br>const hasUpdate = fiber.effectTag &amp; Update<a href="https://t.co/KjXGFKXvSt">https://t.co/KjXGFKXvSt</a> <a href="https://t.co/JSPQBmhIIn">pic.twitter.com/JSPQBmhIIn</a></p>&mdash; Andrew Clark (@acdlite) <a href="https://twitter.com/acdlite/status/942526945161486336?ref_src=twsrc%5Etfw">December 17, 2017</a>
</blockquote>
<p>The React team are making use of bit fields to track component state within the
new fibre architecture of ReactJS! Rather than using React internals as an example
lets try with something simpler to learn how to work with a bit field. </p>
<hr>
<h1>Creating our own bit field</h1>
<p>Imagine we have an object containing the feature toggle state for an application:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
  autoRefresh<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  sidebarWidgets<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  ticker<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Preserving key order, the above data structure can be encoded in to a bit field of
3 bits with each bit corresponding to a key in the object and it’s value
corresponding to the value of the key:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// es6 notation for a binary literal has a prefix of 0b</span>
<span class="token keyword">const</span> appFeatureToggleState <span class="token operator">=</span> <span class="token number">0b010</span></code></pre></div>
<p> The app config can now be passed around in the application as a number primitive.
I know what you’re thinking - Great, what am I supposed to do with that?!</p>
<h2>Operating on bit fields</h2>
<p>When working with bit fields, there are a couple of fundamental operations you’ll definitely want:</p>
<ul>
<li>Setting the value of a bit</li>
<li>Getting the value of a bit</li>
</ul>
<p>This is done through a combination of <em>masking</em> and <em>bitwise operations</em>.
A mask in this context is a another value made up of bits.</p>
<p>Let’s define the bit masks for the feature toggle state example above:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token comment">/*   */</span> <span class="token number">0b00000000</span> <span class="token comment">// all disabled</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> autoRefresh <span class="token operator">=</span> <span class="token comment">/*    */</span> <span class="token number">0b00000001</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> sidebarWidgets <span class="token operator">=</span> <span class="token comment">/* */</span> <span class="token number">0b00000010</span> 
<span class="token keyword">export</span> <span class="token keyword">const</span> ticker <span class="token operator">=</span> <span class="token comment">/*         */</span> <span class="token number">0b00000100</span></code></pre></div>
<h3>Setting the value of a bit</h3>
<p>We can set the value of a bit using the bitwise OR <code class="language-text">|</code> and XOR <code class="language-text">^</code> operators in javascript. </p>
<p>The <code class="language-text">|</code> operator returns a 1 in each bit position for which the corresponding
bits of <strong>either or both</strong> operands are 1s. </p>
<p>The <code class="language-text">^</code> operator returns a 1 in each
bit position for which the corresponding bits of <strong>either but not both</strong> operands are 1s.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; [object Object]; max-width: 510px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACLklEQVQoz51SO4haURB9ZrO+9bOglV0gkCIpt5BAEiNaCRaKYBG0UIkJgp1FwCZVdvFpYWejhdiIjfEXxUbSqPgB//j/gyv+MNrKzdyHCwYTSDJwmLlz586dcxiCODG32037/X5PIIQeYej1eo5Cobg2GAxsi8XCwrHZbGZpNBqOyWRiBwIB5rGWQfylXQDYAPJ4ZgKuACzA5WkhNP31pcPhoH9xuVzPms3m11ar9W06nYa63W6o3++HOp1OZDQahYfDYbjX64UAYagLQe57Op1+dzaKUCjEU1x6PJ6bdru9gCb78Xj8A+IdPN5hD812g8Fgd5LbzGYzlM/nPz30wXS4gGsAn8PhsIl/t6en9FlHfUhoxscaBYNBQaVSuatWq3agSZXLZaper1OQo4Ai1Wg0cGyv1Wp2yN+mUqlALBaTnX0jk8nwL4+dTucroIPm8zlaLpcIdESYFvaLxYLOTyYT2oME6HA4oEwm8+WP83O5XIZOpyPlcjmp1WpJpVJJqlQqUq1Wk7AuTKlUyubxeM8lEskVrM0Fn89/IRAIzqRiQDHjuI/8QqFgAHwAWsZcLmcsFotGEN4I9N+D/+j1ej/j+1KppIOmt36//+XZYGKxGO8YARrewCqg9XqNttstur+/p6ljipvNBq1WKzqH77EM2LLZ7N0ZVavVSnubzcaORCKvo9GoKJlMiiAW4Rj7RCIhisfjonA4/PaYewM1Up/P9+S3+lEURfyvASviJzQwY7NxcPs+AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px rgb(252, 250, 243);"
        alt="Bitwise OR operator example"
        title=""
        src="/static/bitwise-or-5ce69cb9b5df3de0dacbea900d552ce0-41dac.png"
        srcset="/static/bitwise-or-5ce69cb9b5df3de0dacbea900d552ce0-3bf7d.png 195w,
/static/bitwise-or-5ce69cb9b5df3de0dacbea900d552ce0-1949e.png 390w,
/static/bitwise-or-5ce69cb9b5df3de0dacbea900d552ce0-41dac.png 510w"
        sizes="(max-width: 510px) 100vw, 510px"
      />
    </span>
  </span>
  

  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; [object Object]; max-width: 512px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 60.546875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQoz51TO4saURSefWRi3BFWQQmkEILxFUmqCIZokSKVIAqSQmKxG/ITbKKB4C4xjaVNLBQXJC5IEHzXWvgE32/QyjciYQUtbs6dTGSzWoQc+LjfOTPn8Z07QxC3zO/306fT6SQQQoeNRuNYp9NRWq2WMplMbIPBQGHfbDaz9Xo9ZTQaT7xeLwnvHq3X6wPiH+0egATghGPGv31uDQr/nQmT0V2sVusjmO6qXq//6PV639vtdqDVal0DD2De6XSuwQ90u10azWYznk6n3+6MolQq6WnsdrsMEoeQtIbkG0hYgb8CvsIciqyg4Q00WA0Gg5/9fh/lcrmPf+ocATiMrIckSbKZ+CEjcx/ws8dMDrYnzAq2BR9gAsUEcLBcLtdppVL5VCqVvtRqtQs4LzGAX5bLZRqhUOhbsVh0wOSfw+HwVTQafbMjGW4OFydtNttzkIPm8zmazWZoMpmg6XS65TgO8tFisUDL5ZKOZzIZx94rhSlpuQqF4kQqlVIymYwSi8WUSCSi5HI5DeAcLpf7VCAQnAqFQhaPx3vG5/PZd2sdqFQq+pbhUjiFQuEdLPo9yDrLZrM0gJ/n8/kziJ97PB5rKpX6AKsx+3y+i2Aw+OJuQbZEIrmPidvtFmPJWAqWOh6Pt7Ixx5JHoxHtD4dDtNlsEDT8uiPX4fi9BovFworH4y9jsZgmmUyqYeE0MIeYOpFIqCORiAZiGuCvAK/hLxPu3SF81MT/WrVaJX4BAp5XRIqRwqMAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px rgb(252, 250, 243);"
        alt="Bitwise XOR operator example"
        title=""
        src="/static/bitwise-xor-ee0ffe7fe6cc8daa05c1785c3ecfc0cd-422b4.png"
        srcset="/static/bitwise-xor-ee0ffe7fe6cc8daa05c1785c3ecfc0cd-fd15e.png 195w,
/static/bitwise-xor-ee0ffe7fe6cc8daa05c1785c3ecfc0cd-027fe.png 390w,
/static/bitwise-xor-ee0ffe7fe6cc8daa05c1785c3ecfc0cd-422b4.png 512w"
        sizes="(max-width: 512px) 100vw, 512px"
      />
    </span>
  </span>
  </p>
<p>Working with our app config example:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// import our bit masks</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  defaultState<span class="token punctuation">,</span>
  autoRefresh<span class="token punctuation">,</span>
  sidebarWidgets<span class="token punctuation">,</span>
  ticker<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'/featureFlags.js'</span>

<span class="token comment">// set an initial state (no features enabled)</span>
<span class="token keyword">const</span> appFeatureToggleConfig <span class="token operator">=</span> defaultState <span class="token comment">//  0b00000000</span>

<span class="token comment">// set autorefresh toggle to true</span>
appFeatureToggleState <span class="token operator">|=</span> autoRefresh <span class="token comment">//         0b00000001</span>

<span class="token comment">// set ticker toggle to true</span>
appFeatureToggleState <span class="token operator">|=</span> ticker <span class="token comment">//              0b00000101</span>

<span class="token comment">// set sidebarWidgets to true</span>
appFeatureToggleState <span class="token operator">|=</span> sidebarWidgets <span class="token comment">//      0b00000111</span>

<span class="token comment">// set sidebarWidgets to false</span>
appFeatureToggleState <span class="token operator">^=</span> sidebarWidgets <span class="token comment">//      0b00000101</span></code></pre></div>
<h3>Getting the value of a bit</h3>
<p>We can get the value of a bit using the AND <code class="language-text">&amp;</code> operator. The <code class="language-text">&amp;</code> operator
returns a 1 in each bit position for which the corresponding bits of <strong>both</strong>
operands are 1s.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; [object Object]; max-width: 512px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB+ElEQVQoz6VSPWhaURh9NuX11byGDIGELplSB1G6Oeng4KQEV106ujk0UK2ClIJ1Kw4VoUYyiH+LLm4GJSCICP7h////E+c6CbfnPrSUWEpoLxzOuR/nffee7z6G+W15vV6RE4kEQwhhttvtkUaj4XU63bHZbObUajWvUqlOTCYTp9frpQaDQZpKpZ7DK6H+p65j4AR4udMUPPBqx7/WQVOXyyWh7HA4Lnu9XqrT6TyMx+P0YDBI9/v9+70ejUb3w+EwTQFfejKZFAuFwruDq8jlchbEut3uN2jQ6Xa7azRYggV8KKAmUI1GQrvd3u/ni8XiR6lUutn3OQJOd7EueJ6XPnEUrx8X9pGf7ebDchx3BuZ8Pt9Zo9H4Vq/X73CTW3CQotVqBVG/bTabwWw2m6jVanfQ3+GJ5HK564MjjUYjvS1rs9mUMG4QlyAWQSyR6Z5qRCaYr1hDM7Jer0k+n//M/Oe6BCR/e2WJVqsVDR6P57Rarb4vl8sOxLKD7Ri6nepKpULxMZlMfi0Wi074PqD+KZPJqB+fKJXJZC+oCAQCVzSKIAhkuVyS+XwuMt1TvVqtyGw2E2vT6ZRsNhuC3+bLQQan0ymyxWJhY7GYPBKJKOPxuCIcDiugFVRHo1ERoVBISevw0fpbv99//sfBWK3Wfx4qXpr5CU38VeGkFBX4AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px rgb(252, 250, 243);"
        alt="Bitwise AND operator example"
        title=""
        src="/static/bitwise-and-83f3994733ef373e404a509c0cb00053-422b4.png"
        srcset="/static/bitwise-and-83f3994733ef373e404a509c0cb00053-fd15e.png 195w,
/static/bitwise-and-83f3994733ef373e404a509c0cb00053-027fe.png 390w,
/static/bitwise-and-83f3994733ef373e404a509c0cb00053-422b4.png 512w"
        sizes="(max-width: 512px) 100vw, 512px"
      />
    </span>
  </span>
  </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// to check if the ticker is enabled we just have to </span>
<span class="token comment">// check if the operation returns our mask</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>appFeatureToggleState <span class="token operator">&amp;</span> ticker <span class="token operator">===</span> ticker<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token operator">...</span>doSomething</code></pre></div>
<p>The reason we have to check that the return value matches the mask is because more
than one value can be set in the bitfield at once; so it's not enough to check
for a truthy value.</p>
<h3>Getting the value of a bit without a pre-defined mask</h3>
<p>You can save even more memory by accessing bits without pre-defined masks.
This can be done via bitshifting with the left shift <code class="language-text">&lt;&lt;</code> operator. The <code class="language-text">&lt;&lt;</code>
operator shifts bits from right to left in 0's. Accessing the same ticker
bit as before without the predefined mask:</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; [object Object]; max-width: 506px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 55.13833992094862%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6klEQVQoz51SPYsaURSd6GbdVaOTEAwE0ZiZ4DaW/gKxthECgqWKjYiKWopFAmJwJdikSbmBZJ3CJj/ADxQULUT8RkSNKKIyC+lezgyzIonLQi4c7plz3zv3zX2Poo6CEHLgyWRS4XQ61W63WxWLxS58Pp8yEolculwuNfRn2WxW4fV6lR6PR4maqlKpyKlTcWyKuACUgAy433AGnEv8UuKKk2br9VrMqVTK0O12bwaDATebzX6A58HzvV6PG4/H+clkcguNGw6Ht9C+Y83PZrMZePB06XTagoW/sOH3dDrlwfnRaMT3+30ehjwM76DdoS7k3WKxIK1W68s/hnL5YQxPWJbV6PV6LbLWYDCIMJlMWqPRKGaGYTTgGovFoqJp+g1AHzYDWgnPpbk8Gna7/RxNaJhrdDrdK5vNdnZcl92bm81m2ZH+AlBJlyM0U0sQmr5+5EIpmd/vF05L5XK5l7Va7UO5XM42Go1MqVQScI3vTLVazUD7VCgUvtbr9TT4x3a7/blYLL7/u4HaarWK189x3BWGT3a7HeF5nqxWK7LZbMS83W7Jfr8ny+VSrM/ncyJEp9P59uB8HA7HUzxiUzAYZOPxOIPMhMNhJhQKiTkajTL4G1bQob3Fw38XCAR0J80SiQT1vyHM8A+N8/or07tiQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px rgb(252, 250, 243);"
        alt="Left shift operator example"
        title=""
        src="/static/left-shift-b4015578992f6cfba1250b8dda1120c1-42fce.png"
        srcset="/static/left-shift-b4015578992f6cfba1250b8dda1120c1-30845.png 195w,
/static/left-shift-b4015578992f6cfba1250b8dda1120c1-cad2e.png 390w,
/static/left-shift-b4015578992f6cfba1250b8dda1120c1-42fce.png 506w"
        sizes="(max-width: 506px) 100vw, 506px"
      />
    </span>
  </span>
  </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token comment">// the predefined mask is now replaced with the expression (1 &lt;&lt; n) </span>
  <span class="token comment">// where n === the bit you want to get</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>appFeatureToggleState <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>doSomething</code></pre></div>
<p><strong>Hint:</strong> The expression <code class="language-js"><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">)</span></code> is equivalent to <code class="language-js">Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span></code>.  </p>
<p>You could also just use the literal binary value:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token keyword">if</span> <span class="token punctuation">(</span>appFeatureToggleState <span class="token operator">&amp;</span> <span class="token number">0b00000100</span> <span class="token operator">===</span> <span class="token number">0b00000100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>doSomething</code></pre></div>
<hr>
<h3>Final thoughts</h3>
<p>When using bit fields, we are trading off readability for optimisations in
performance/memory usage. It’s advisable to attempt other methods of optimisation
before making use of bit fields! - However it's always good to have something in
your back pocket for when the time calls. This post also hopefully helps shed some
light on the lengths javascript library authors are going to to help shave some bytes
off the final bundle size and ensure the best performance possible where needed.</p>
<p>If you are interested in working with bitfields checkout the <a href="https://github.com/fb55/bitfield">bitfield</a>
library on NPM which supports a variety of data structures as the backing data
structure for your bitfield including NodeJS buffers, arrays and even a number
representing the max bytes! It also has handy abstractions for getting and setting
field values which allows you to avoid the lower level bitshifting operations
if you wish ;)</p>
<p>Special thanks to <a href="https://twitter.com/loige">@lammino</a> and <a href="https://twitter.com/katavic_d">@dkatvic</a>
for taking the time to review this post.</p>
<p>I'll leave you with a handy table detailing bitwise operators in javascript courtesy of
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">MDN</a>:</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; [object Object]; max-width: 779px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 39.60573476702509%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABNElEQVQoz11RSXLDMAzz/x/ZabxHtiRr8ZJcUECOk7YHDClSBLhUdTegNzOWvMHFjKYfMRiLr1sD4xa4kGCXSKQT7/dfeNYuaUNl0wrDj3k/sBJLTJisQzeMGM2Eputxa1q0fMtv+wHfdVP8uu3eth/vJMyo5pAhiCy/CF0IVEyIeS2fFPvYBB9iyftfccdYIdSolu3uxxP744m8bvBLwCBFfnJ+gXW++AUqZl6+/xcLtKXDiXvZjwc2onQRI+7TDDPbMr58daspEgXztr/t5atWDVWjY7GnGncZdBgqzexIRIL2ONxNIVf8FJpL/BKVL0GRnjvkyBo7rnshtBxTxcJVYOyLkG8RCYpfgiGdd6jSdrC7DYFkGjsyoR3WvGzPy9ZNU/aZ2IGg/AXtLBKBK1Lu4Mg/bJtgDnvP1AsAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px rgb(252, 250, 243);"
        alt="Bitwise Operators"
        title=""
        src="/static/bitwise-operators-51154f246f0040a8d38dc55b259088c1-b2622.png"
        srcset="/static/bitwise-operators-51154f246f0040a8d38dc55b259088c1-85012.png 195w,
/static/bitwise-operators-51154f246f0040a8d38dc55b259088c1-0d485.png 390w,
/static/bitwise-operators-51154f246f0040a8d38dc55b259088c1-b2622.png 779w,
/static/bitwise-operators-51154f246f0040a8d38dc55b259088c1-cf4d0.png 1116w"
        sizes="(max-width: 779px) 100vw, 779px"
      />
    </span>
  </span>
  </p></div><div><h3>Recommended reading</h3><div><a style="font-size:0.85rem" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators</a></div><div><a style="font-size:0.85rem" href="https://en.wikipedia.org/wiki/Bit_field">https://en.wikipedia.org/wiki/Bit_field</a></div></div></div></div></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-127173512-1', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"blog-bit-fields-8f3","path":"/blog/bit-fields/"};window.dataPath="905/path---blog-bit-fields-8-f-3-9f8-HhUAVOitfsQhnBmNWv3m0O8CJJk";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.e5d44cb3cd153caeaaff.css","/app-085d23b9c77fd27162d3.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-d79211abe6d5d7c17036.js"],"component---src-pages-about-js":["/component---src-pages-about-js-1c613e64d564675d60ac.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5d9a2a57592983febeff.js"]};/*]]>*/</script><script src="/webpack-runtime-f0271498a59faa340b94.js" async=""></script><script src="/app-085d23b9c77fd27162d3.js" async=""></script><script src="/6-047ac21c7ff64682f062.js" async=""></script><script src="/component---src-templates-blog-post-js-d79211abe6d5d7c17036.js" async=""></script><script src="/0-77912da1a899ed9cb720.js" async=""></script></body></html>